<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Camera - Emotion AI</title>
    <meta name="description" content="Real-time emotion detection via live camera feed">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Configuration Tailwind personnalis√©e -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#dc2626',        // Rouge intense (comme Netflix, YouTube)
                        'secondary': '#991b1b',      // Rouge sombre premium
                        'accent': '#ffffff',         // Blanc pur pour contraste
                        'dark': '#0f0f0f',          // Noir profond
                        'gray-dark': '#262626',      // Gris sombre
                    },
                    animation: {
                        'pulse-glow': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'scan': 'scan 2s linear infinite',
                        'fade-in': 'fadeIn 0.6s ease-out'
                    }
                }
            }
        }
    </script>
    
    <!-- Styles personnalis√©s -->
    <style>
        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .gradient-bg {
            background: linear-gradient(135deg, #0f0f0f 0%, #991b1b 50%, #dc2626 100%);
            background-size: 200% 200%;
            animation: gradientMove 10s ease infinite;
        }
        @keyframes gradientMove {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        .glass-effect {
            backdrop-filter: blur(20px);
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(220, 38, 38, 0.3);
        }
        .camera-frame {
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(220, 38, 38, 0.4);
            border-radius: 1rem;
            background: rgba(0, 0, 0, 0.8);
        }
        .camera-frame::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 100%;
            background: linear-gradient(to bottom, transparent, #dc2626, transparent);
            animation: scan 3s ease-in-out infinite;
            z-index: 10;
            box-shadow: 0 0 15px #dc2626;
        }
        .startup-shadow {
            box-shadow: 0 20px 25px -5px rgba(220, 38, 38, 0.2), 
                       0 10px 10px -5px rgba(0, 0, 0, 0.5);
        }
        .status-indicator {
            animation: pulse 2s infinite;
        }
        .premium-gradient {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
        }
        .accent-gradient {
            background: linear-gradient(135deg, #991b1b 0%, #ffffff 100%);
        }
        .dark-card {
            background: rgba(15, 15, 15, 0.9);
            border: 1px solid rgba(220, 38, 38, 0.2);
        }
        .red-glow {
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.3);
        }
    </style>
</head>
<body class="min-h-screen gradient-bg">
    <!-- Navigation header -->
    <nav class="relative z-20 px-6 py-4">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 premium-gradient rounded-lg flex items-center justify-center shadow-lg red-glow">
                    <span class="text-xl">üé•</span>
                </div>
                <h1 class="text-xl font-bold text-white">Emotion AI</h1>
            </div>
            <div class="flex items-center space-x-4">
                <div class="status-indicator w-3 h-3 bg-primary rounded-full red-glow"></div>
                <span class="text-white/80 text-sm font-medium">LIVE</span>
            </div>
        </div>
    </nav>

    <!-- Contenu principal -->
    <div class="relative z-10 max-w-7xl mx-auto px-6 py-8">
        <!-- En-t√™te de section -->
        <div class="text-center mb-12">
            <div class="inline-flex items-center dark-card rounded-full px-6 py-3 mb-6 red-glow">
                <div class="w-6 h-6 premium-gradient rounded-lg flex items-center justify-center mr-2">
                    <span class="text-sm">üé•</span>
                </div>
                <span class="text-white font-medium">Live Detection</span>
            </div>
            <h2 class="text-4xl md:text-5xl font-bold text-white mb-4">
                Real-time 
                <span class="bg-gradient-to-r from-primary to-white bg-clip-text text-transparent">
                    Analysis
                </span>
            </h2>
            <p class="text-xl text-white/70 max-w-2xl mx-auto">
                Professional AI emotion detection via live camera feed
            </p>
        </div>

        <!-- Conteneur de la cam√©ra -->
        <div class="max-w-4xl mx-auto mb-12">
            <!-- Cadre de la cam√©ra -->
            <div class="dark-card rounded-2xl p-6 startup-shadow red-glow">
                <div class="relative camera-frame rounded-xl overflow-hidden">
                    <!-- Indicateurs de statut -->
                    <div class="absolute top-4 left-4 z-20 flex items-center space-x-3">
                        <div class="bg-black/70 rounded-full px-3 py-1 flex items-center space-x-2 border border-primary/30">
                            <div class="w-2 h-2 bg-primary rounded-full animate-pulse"></div>
                            <span class="text-white text-sm font-medium">REC</span>
                        </div>
                        <div class="bg-black/70 rounded-full px-3 py-1 border border-primary/20">
                            <span class="text-white text-sm" id="timestamp"></span>
                        </div>
                    </div>
                    
                    <!-- Indicateurs d'√©motions en overlay -->
                    <div class="absolute top-4 right-4 z-20">
                        <div class="bg-black/70 rounded-xl p-3 space-y-2 border border-primary/30">
                            <div class="text-white text-sm font-medium">Current Emotion</div>
                            <div id="emotionBadges" class="space-y-1">
                                <div class="text-primary text-lg font-bold">--</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Grille d'analyse -->
                    <div class="absolute inset-0 z-10 pointer-events-none">
                        <svg class="w-full h-full opacity-20" viewBox="0 0 100 100" preserveAspectRatio="none">
                            <defs>
                                <pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse">
                                    <path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(220, 38, 38, 0.3)" stroke-width="0.5"/>
                                </pattern>
                            </defs>
                            <rect width="100" height="100" fill="url(#grid)" />
                        </svg>
                    </div>
                    
                    <!-- Flux vid√©o -->
                    <img src="{{ url_for('video_feed') }}" 
                         alt="Live video feed"
                         class="w-full h-auto min-h-[400px] object-cover"
                         id="videoFeed">
                </div>
                
                <!-- Contr√¥les de la cam√©ra -->
                <div class="flex justify-between items-center mt-6">
                    <div class="flex space-x-3">
                        <button id="toggleDetection" 
                                class="premium-gradient text-white px-6 py-3 rounded-xl transition-all duration-300 flex items-center space-x-2 hover:shadow-lg red-glow">
                            <span class="text-lg">‚è∏Ô∏è</span>
                            <span class="font-medium">Pause</span>
                        </button>
                        <button id="captureBtn" 
                                class="bg-gray-dark hover:bg-gray-600 text-white px-6 py-3 rounded-xl transition-all duration-300 flex items-center space-x-2 border border-primary/30">
                            <span class="text-lg">üì∏</span>
                            <span class="font-medium">Capture</span>
                        </button>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button id="settingsBtn" 
                                class="bg-gray-dark hover:bg-gray-600 text-white p-3 rounded-xl transition-all duration-300 border border-primary/20">
                            <span class="text-lg">‚öôÔ∏è</span>
                        </button>
                        <button id="fullscreenBtn" 
                                class="bg-gray-dark hover:bg-gray-600 text-white p-3 rounded-xl transition-all duration-300 border border-primary/20">
                            <span class="text-lg">‚õ∂</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistiques en temps r√©el -->
        <div class="grid md:grid-cols-3 gap-6 mb-12">
            <div class="dark-card rounded-xl p-6 text-center startup-shadow">
                <div class="text-3xl mb-2">üòä</div>
                <div class="text-white text-lg font-medium">Happy</div>
                <div class="text-primary text-2xl font-bold" id="happyScore">0%</div>
            </div>
            <div class="dark-card rounded-xl p-6 text-center startup-shadow">
                <div class="text-3xl mb-2">üò†</div>
                <div class="text-white text-lg font-medium">Angry</div>
                <div class="text-primary text-2xl font-bold" id="angerScore">0%</div>
            </div>
            <div class="dark-card rounded-xl p-6 text-center startup-shadow">
                <div class="text-3xl mb-2">üò¢</div>
                <div class="text-white text-lg font-medium">Sad</div>
                <div class="text-primary text-2xl font-bold" id="sadnessScore">0%</div>
            </div>
        </div>

        <!-- Actions -->
        <div class="text-center space-y-6">
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="/" 
                   class="inline-flex items-center justify-center bg-white/10 hover:bg-white/20 text-white font-medium py-3 px-6 rounded-xl transition-all duration-300">
                    <span class="mr-2">‚¨ÖÔ∏è</span>
                    Back to Home
                </a>
                <button id="downloadBtn" 
                        class="inline-flex items-center justify-center accent-gradient text-white font-medium py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-300">
                    <span class="mr-2">üíæ</span>
                    Download Session
                </button>
            </div>
            
            <!-- Informations techniques -->
            <div class="glass-effect rounded-xl p-4 inline-block">
                <div class="text-white/70 text-sm space-x-4">
                    <span>FPS: <span id="fpsCounter" class="text-accent font-mono">--</span></span>
                    <span>‚Ä¢</span>
                    <span>Latency: <span id="latencyCounter" class="text-accent font-mono">--ms</span></span>
                    <span>‚Ä¢</span>
                    <span>Quality: <span class="text-green-400">HD</span></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="relative z-10 mt-16 text-center text-white/50">
        <div class="max-w-7xl mx-auto px-6 py-8 border-t border-white/10">
            <p class="mb-2">Real-time analysis ‚Ä¢ Privacy protected üîí</p>
            <p class="text-sm">No video data stored ‚Ä¢ Secure local processing</p>
        </div>
    </footer>

    <!-- JavaScript pour les interactions -->
    <script>
        // Progressive Enhancement et gestion d'√©tat de l'interface
        
        // 1. Horloge en temps r√©el
        function updateTimestamp() {
            const now = new Date();
            const timestamp = now.toLocaleTimeString();
            document.getElementById('timestamp').textContent = timestamp;
        }
        setInterval(updateTimestamp, 1000);
        updateTimestamp();
        
        // 2. Simulation du compteur FPS (√† remplacer par de vraies m√©triques)
        function updateMetrics() {
            const fps = Math.floor(Math.random() * 5) + 25; // 25-30 FPS simul√©
            const latency = Math.floor(Math.random() * 20) + 10; // 10-30ms simul√©
            
            document.getElementById('fpsCounter').textContent = fps;
            document.getElementById('latencyCounter').textContent = latency + 'ms';
        }
        setInterval(updateMetrics, 2000);
        updateMetrics();
        
        // 3. Gestion des contr√¥les de cam√©ra
        let isDetectionActive = true;
        
        document.getElementById('toggleDetection').addEventListener('click', function() {
            isDetectionActive = !isDetectionActive;
            const btn = this;
            
            if (isDetectionActive) {
                btn.innerHTML = '<span class="text-lg">‚è∏Ô∏è</span><span class="font-medium">Pause</span>';
                btn.className = btn.className.replace('accent-gradient', 'premium-gradient');
            } else {
                btn.innerHTML = '<span class="text-lg">‚ñ∂Ô∏è</span><span class="font-medium">Resume</span>';
                btn.className = btn.className.replace('premium-gradient', 'accent-gradient');
            }
        });
        
        // 4. Capture d'√©cran
        document.getElementById('captureBtn').addEventListener('click', function() {
            // Effet visuel de capture
            const flash = document.createElement('div');
            flash.className = 'fixed inset-0 bg-white opacity-75 z-50 pointer-events-none';
            document.body.appendChild(flash);
            
            setTimeout(() => {
                document.body.removeChild(flash);
            }, 100);
            
            // Animation du bouton
            this.classList.add('animate-pulse');
            setTimeout(() => {
                this.classList.remove('animate-pulse');
            }, 1000);
        });
        
        // 5. Mode plein √©cran
        document.getElementById('fullscreenBtn').addEventListener('click', function() {
            const videoContainer = document.querySelector('.camera-frame');
            
            if (!document.fullscreenElement) {
                videoContainer.requestFullscreen().catch(err => {
                    console.log('Erreur plein √©cran:', err);
                });
            } else {
                document.exitFullscreen();
            }
        });
        
        // 6. Simulation des scores d'√©motions (√† remplacer par vraies donn√©es)
        function updateEmotionScores() {
            const emotions = ['happyScore', 'angerScore', 'sadnessScore'];
            emotions.forEach(emotion => {
                const score = Math.floor(Math.random() * 100);
                const element = document.getElementById(emotion);
                if (element) {
                    element.textContent = score + '%';
                }
            });
        }
        setInterval(updateEmotionScores, 3000);
        
        // 7. Gestion des erreurs de flux vid√©o
        const videoFeed = document.getElementById('videoFeed');
        videoFeed.addEventListener('error', function() {
            this.style.background = 'linear-gradient(135deg, #374151, #4b5563)';
            this.alt = 'Camera connection error';
        });
        
        // 8. Raccourcis clavier accessibilit√©
        document.addEventListener('keydown', function(e) {
            if (e.key === ' ') { // Espace pour pause/play
                e.preventDefault();
                document.getElementById('toggleDetection').click();
            } else if (e.key === 'c' && e.ctrlKey) { // Ctrl+C pour capture
                e.preventDefault();
                document.getElementById('captureBtn').click();
            }
        });
    </script>
    
    <!-- Styles d'accessibilit√© -->
    <style>
        /* Navigation clavier visible */
        .keyboard-navigation *:focus {
            outline: 2px solid #06b6d4 !important;
            outline-offset: 2px !important;
        }
        
        /* Respect pr√©f√©rences utilisateur pour r√©duction mouvement */
        @media (prefers-reduced-motion: reduce) {
            .animate-pulse,
            .camera-frame::before {
                animation: none !important;
            }
            
            * {
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Mode sombre natif */
        @media (prefers-color-scheme: dark) {
            .glass-effect {
                background: rgba(0, 0, 0, 0.3);
            }
        }
        
        /* Mode plein √©cran */
        .camera-frame:fullscreen {
            background: black;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .camera-frame:fullscreen img {
            max-width: 100vw;
            max-height: 100vh;
            object-fit: contain;
        }
    </style>
</body>
</html>
